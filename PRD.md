# AI旅行规划助手 - 产品需求文档 (PRD)

## 文档信息
- **产品名称**: AI Travel Planner (AI旅行规划助手)
- **文档版本**: v1.0
- **创建日期**: 2025年10月22日
- **产品类型**: Web应用
- **目标平台**: 桌面浏览器、移动浏览器

---

## 1. 产品概述

### 1.1 产品定位
AI旅行规划助手是一款基于人工智能的智能旅行规划Web应用，旨在通过语音和文字交互方式，为用户提供个性化的旅行路线规划、预算管理和实时旅行辅助服务。

### 1.2 产品愿景
简化旅行规划过程，让每个人都能轻松规划一次完美的旅行。

### 1.3 目标用户
- 喜欢自由行但缺乏规划经验的旅行者
- 希望快速获得个性化旅行方案的用户
- 需要精确预算控制的旅行者
- 家庭出游、情侣旅行、独自旅行等各类人群

### 1.4 核心价值
- **智能化**: AI驱动的个性化行程规划
- **便捷性**: 语音交互，快速生成方案
- **全面性**: 涵盖交通、住宿、景点、餐饮等全方位信息
- **实用性**: 实时预算管理和费用跟踪

---

## 2. 功能需求

### 2.1 智能行程规划模块

#### 2.1.1 输入方式
**优先级**: P0 (必须实现)

**功能描述**:
- 支持语音输入（必须功能）
- 支持文字输入（必须功能）
- 语音和文字可混合使用

**用户输入信息**:
- 旅行目的地（必填）
- 出行日期/旅行天数（必填）
- 预算范围（必填）
- 同行人数及类型（如：成人、儿童、老人）
- 旅行偏好（如：美食、历史文化、自然风光、购物、动漫等）
- 特殊需求（如：无障碍设施、素食等）

**示例交互**:
> 用户（语音）："我想去日本，5天，预算1万元，喜欢美食和动漫，带孩子"

#### 2.1.2 AI行程生成
**优先级**: P0

**功能描述**:
基于用户输入，AI自动生成详细的个性化旅行方案

**输出内容**:
1. **每日行程安排**
   - 时间线规划（精确到小时）
   - 景点/活动详细信息
   - 预计停留时间
   - 景点间交通方式及时长

2. **交通规划**
   - 往返交通建议（飞机/火车/自驾等）
   - 城市内交通方案
   - 具体路线指引
   - 交通费用预估

3. **住宿推荐**
   - 酒店/民宿推荐（3-5个选项）
   - 位置、价格、设施信息
   - 预订建议

4. **餐饮推荐**
   - 特色餐厅推荐
   - 美食推荐
   - 预算预估

5. **费用明细**
   - 详细费用分类（交通、住宿、餐饮、门票、其他）
   - 总预算评估
   - 节省建议

6. **注意事项**
   - 天气提醒
   - 当地习俗
   - 必备物品清单
   - 安全提示

#### 2.1.3 行程展示
**优先级**: P0

**UI要求**:
- 地图为主的交互界面（集成地图API）
- 时间轴/卡片式行程展示
- 美观的景点图片展示
- 清晰的信息层级结构
- 响应式设计，适配移动端

#### 2.1.4 行程编辑
**优先级**: P1

**功能描述**:
- 支持调整行程顺序（拖拽）
- 添加/删除景点
- 修改时间安排
- 保存多个方案版本

### 2.2 费用预算与管理模块

#### 2.2.1 AI预算分析
**优先级**: P0

**功能描述**:
- 基于目的地和用户需求，AI自动生成预算方案
- 预算分类明细（交通、住宿、餐饮、景点门票、购物、预备金）
- 每日预算分配
- 预算优化建议

#### 2.2.2 开销记录
**优先级**: P1

**功能描述**:
- 支持语音记录开销（推荐功能）
- 支持手动输入开销
- 分类记账（与预算分类对应）
- 添加备注和照片

**示例交互**:
> 用户（语音）："记录午餐费用200元"

#### 2.2.3 预算追踪
**优先级**: P1

**功能描述**:
- 实时显示已花费金额和剩余预算
- 可视化图表展示（饼图、柱状图）
- 超支预警
- 支出分析报告

### 2.3 用户管理与数据存储模块

#### 2.3.1 注册登录系统
**优先级**: P0

**功能描述**:
- 邮箱注册/登录
- 第三方账号登录（Google、Apple、微信等，可选）
- 密码找回功能
- 账号安全设置

**数据验证**:
- 邮箱格式验证
- 密码强度要求（至少8位，包含字母和数字）

#### 2.3.2 旅行计划管理
**优先级**: P0

**功能描述**:
- 创建多份旅行计划
- 保存草稿和历史计划
- 计划列表查看（卡片式）
- 计划状态标识（规划中、进行中、已完成）
- 计划搜索和筛选

#### 2.3.3 云端数据同步
**优先级**: P0

**功能描述**:
- 实时云端同步
- 支持多设备访问
- 离线数据缓存
- 数据冲突处理

**同步数据内容**:
- 旅行计划
- 用户偏好设置
- 费用记录
- 个人收藏

#### 2.3.4 用户偏好设置
**优先级**: P2

**功能描述**:
- 常用出发地设置
- 旅行偏好标签管理
- 预算范围默认值
- 语音识别语言选择

### 2.4 地图导航模块

#### 2.4.1 地图展示
**优先级**: P0

**功能描述**:
- 集成地图API（高德/百度地图）
- 显示所有行程地点标记
- 路线可视化
- 地点详情弹窗

#### 2.4.2 导航功能
**优先级**: P1

**功能描述**:
- 实时导航（跳转到地图APP）
- 路线规划
- 距离和时间估算
- 周边服务查询（餐厅、便利店、ATM等）

### 2.5 API密钥管理模块

#### 2.5.1 密钥配置
**优先级**: P0

**功能描述**:
- 设置页面提供API密钥输入框
- 支持配置以下API密钥：
  - 大语言模型API Key
  - 语音识别API Key
  - 地图服务API Key
- 密钥加密存储
- 密钥验证功能

**安全要求**:
- 密钥不在代码中硬编码
- 不提交到公开代码库
- 支持环境变量配置（开发环境）
- 用户端密钥仅存储在本地/加密传输

---

## 3. 技术需求

### 3.1 技术栈建议

#### 3.1.1 前端
**可选方案**:
- React + TypeScript + Vite
- Vue 3 + TypeScript + Vite
- Next.js (React框架)
- Nuxt.js (Vue框架)

**UI框架建议**:
- Tailwind CSS
- Material-UI / Ant Design / Element Plus
- Shadcn UI

#### 3.1.2 后端/数据库
**推荐方案**（免费）:
- **Supabase** (推荐)
  - PostgreSQL数据库
  - 用户认证
  - 实时订阅
  - 存储服务
  
- **Firebase** (备选)
  - Firestore数据库
  - Firebase Authentication
  - Cloud Storage

- **其他选择**:
  - Appwrite
  - PocketBase
  - MongoDB Atlas (免费套餐)

#### 3.1.3 第三方服务

**语音识别**（必须，选一个免费方案）:
- 科大讯飞语音API
- Web Speech API (浏览器原生)
- Azure Speech Service (免费额度)
- Google Cloud Speech-to-Text (免费额度)

**地图服务**（必须）:
- 高德地图Web API (推荐，国内)
- 百度地图Web API (备选，国内)
- Google Maps API (国际)

**大语言模型**（必须，自选）:
- OpenAI API (GPT-4/GPT-3.5)
- Anthropic Claude API
- 文心一言API
- 通义千问API
- 智谱AI API (ChatGLM)
- DeepSeek API
- 开源模型 (Ollama本地部署)

#### 3.1.4 部署
**免费部署平台**:
- Vercel (推荐，前端)
- Netlify (前端)
- Cloudflare Pages (前端)
- Railway (全栈)
- Render (全栈)

### 3.2 数据库设计

#### 3.2.1 用户表 (users)
```
- id: UUID (主键)
- email: String (唯一)
- password_hash: String
- username: String
- created_at: Timestamp
- updated_at: Timestamp
- avatar_url: String (可选)
```

#### 3.2.2 旅行计划表 (travel_plans)
```
- id: UUID (主键)
- user_id: UUID (外键)
- title: String
- destination: String
- start_date: Date
- end_date: Date
- days: Integer
- budget: Decimal
- travelers_count: Integer
- preferences: JSON
- status: Enum (planning, ongoing, completed)
- created_at: Timestamp
- updated_at: Timestamp
```

#### 3.2.3 行程详情表 (itinerary_details)
```
- id: UUID (主键)
- plan_id: UUID (外键)
- day: Integer
- itinerary_data: JSON (完整的AI生成内容)
- created_at: Timestamp
- updated_at: Timestamp
```

#### 3.2.4 费用记录表 (expenses)
```
- id: UUID (主键)
- plan_id: UUID (外键)
- category: String (交通、住宿、餐饮等)
- amount: Decimal
- description: String
- date: Date
- created_at: Timestamp
- image_url: String (可选)
```

#### 3.2.5 用户偏好表 (user_preferences)
```
- id: UUID (主键)
- user_id: UUID (外键)
- default_departure: String
- favorite_categories: JSON
- default_budget_range: JSON
- language: String
- created_at: Timestamp
- updated_at: Timestamp
```

#### 3.2.6 API配置表 (api_configs)
```
- id: UUID (主键)
- user_id: UUID (外键)
- service_type: String (llm, speech, map)
- api_key_encrypted: String
- created_at: Timestamp
- updated_at: Timestamp
```

### 3.3 API设计

#### 3.3.1 用户相关API
- `POST /api/auth/register` - 用户注册
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/logout` - 用户登出
- `GET /api/user/profile` - 获取用户信息
- `PUT /api/user/profile` - 更新用户信息
- `PUT /api/user/preferences` - 更新用户偏好

#### 3.3.2 旅行计划API
- `POST /api/plans` - 创建旅行计划
- `GET /api/plans` - 获取用户的所有计划
- `GET /api/plans/:id` - 获取特定计划详情
- `PUT /api/plans/:id` - 更新计划
- `DELETE /api/plans/:id` - 删除计划

#### 3.3.3 AI生成API
- `POST /api/ai/generate-itinerary` - 生成行程
- `POST /api/ai/analyze-budget` - 预算分析
- `POST /api/ai/optimize-route` - 路线优化

#### 3.3.4 费用管理API
- `POST /api/expenses` - 添加费用记录
- `GET /api/expenses/:planId` - 获取计划的所有费用
- `PUT /api/expenses/:id` - 更新费用记录
- `DELETE /api/expenses/:id` - 删除费用记录
- `GET /api/expenses/:planId/summary` - 获取费用统计

#### 3.3.5 语音处理API
- `POST /api/voice/transcribe` - 语音转文字
- `POST /api/voice/process-command` - 处理语音命令

#### 3.3.6 API密钥管理
- `POST /api/config/keys` - 保存API密钥
- `GET /api/config/keys` - 获取密钥配置状态（不返回实际密钥）
- `DELETE /api/config/keys/:type` - 删除指定类型密钥

---

## 4. 非功能性需求

### 4.1 性能要求
- 页面首次加载时间 < 3秒
- AI生成行程响应时间 < 10秒
- 语音识别响应时间 < 2秒
- 支持至少100个并发用户

### 4.2 安全要求
- 使用HTTPS加密传输
- API密钥加密存储
- 用户密码Hash存储（bcrypt/argon2）
- SQL注入防护
- XSS攻击防护
- CSRF防护
- API请求频率限制

### 4.3 兼容性要求
**浏览器支持**:
- Chrome (最新版及前2个版本)
- Firefox (最新版及前2个版本)
- Safari (最新版及前2个版本)
- Edge (最新版及前2个版本)
- 移动端浏览器 (iOS Safari, Android Chrome)

**屏幕适配**:
- 桌面端: 1920×1080, 1440×900, 1366×768
- 平板: iPad Pro, iPad, Android平板
- 手机: iPhone (各型号), Android (各分辨率)

### 4.4 可用性要求
- 响应式设计，适配所有设备
- 清晰的用户引导和帮助文档
- 友好的错误提示
- 无障碍性支持（WCAG 2.1 AA标准）

### 4.5 可维护性要求
- 代码模块化设计
- 完整的代码注释
- 统一的代码风格（ESLint/Prettier）
- Git版本控制
- 详细的开发文档

### 4.6 可扩展性要求
- 支持多语言扩展（国际化 i18n）
- 支持多种AI模型切换
- 支持插件化功能扩展
- 支持主题定制

---

## 5. 用户界面设计

### 5.1 页面结构

#### 5.1.1 首页/登录页
- 产品介绍
- 登录/注册入口
- 快速体验入口

#### 5.1.2 主控制台
- 顶部导航栏（Logo、菜单、用户头像）
- 侧边栏（我的计划、新建计划、费用管理、设置）
- 主内容区

#### 5.1.3 行程规划页
- 输入区域（语音/文字输入框）
- 地图展示区（占据主要空间）
- 行程时间轴（侧边或下方）
- 详情面板（可折叠）

#### 5.1.4 计划详情页
- 计划概览卡片
- 每日行程展示
- 地图可视化
- 费用统计
- 编辑/分享功能

#### 5.1.5 费用管理页
- 费用列表
- 统计图表
- 添加费用入口（支持语音）
- 预算对比

#### 5.1.6 设置页
- 个人信息设置
- API密钥配置
- 偏好设置
- 账号安全

### 5.2 交互设计要点

#### 5.2.1 语音交互
- 明显的麦克风按钮
- 录音状态可视化（波形动画）
- 实时转写显示
- 语音命令反馈

#### 5.2.2 地图交互
- 点击标记显示详情
- 拖拽调整路线
- 缩放和平移
- 图层切换（卫星/街道）

#### 5.2.3 行程编辑
- 拖拽排序
- 快速添加/删除
- 撤销/重做
- 自动保存

### 5.3 视觉设计要求
- 现代化的扁平设计风格
- 清晰的视觉层级
- 舒适的配色方案（主色、辅助色、强调色）
- 美观的景点图片展示
- 统一的图标体系
- 流畅的动画效果

---

## 6. 开发阶段规划

### 6.1 第一阶段（MVP - 最小可行产品）
**优先级**: P0功能
**预计时间**: 4-6周

**包含功能**:
1. 用户注册登录
2. 基础语音输入和文字输入
3. AI行程生成（基础版）
4. 简单的地图展示
5. 云端数据存储和同步
6. API密钥配置

**交付标准**:
- 用户可以注册登录
- 可以通过语音或文字输入需求
- AI能够生成基本的旅行方案
- 方案可以保存和查看
- 可以配置必要的API密钥

### 6.2 第二阶段（功能完善）
**优先级**: P1功能
**预计时间**: 3-4周

**包含功能**:
1. 费用预算与管理完整功能
2. 行程编辑功能
3. 地图导航功能
4. 语音记录开销
5. 优化UI/UX设计

**交付标准**:
- 完整的预算管理功能
- 可以编辑和调整行程
- 地图交互体验良好
- 语音功能稳定可靠

### 6.3 第三阶段（优化增强）
**优先级**: P2功能
**预计时间**: 2-3周

**包含功能**:
1. 用户偏好设置
2. 行程分享功能
3. 多语言支持
4. 性能优化
5. 移动端体验优化

**交付标准**:
- 用户体验流畅
- 响应速度快
- 移动端适配完美
- 功能稳定可靠

---

## 7. 测试需求

### 7.1 功能测试
- 用户注册登录流程
- 语音识别准确性
- AI生成内容质量
- 数据存储和同步
- API密钥配置

### 7.2 性能测试
- 页面加载速度
- AI响应时间
- 并发用户压力测试
- 移动端性能

### 7.3 安全测试
- 身份认证安全性
- API密钥安全性
- 数据传输安全性
- 常见攻击防护

### 7.4 兼容性测试
- 多浏览器测试
- 多设备测试
- 多分辨率测试

### 7.5 用户体验测试
- 可用性测试
- A/B测试
- 用户反馈收集

---

## 8. 风险与挑战

### 8.1 技术风险
- **AI生成质量不稳定**: 需要优化Prompt工程和结果验证
- **API费用超支**: 实施请求限制和缓存策略
- **语音识别准确率**: 多个方案备选，优化语音识别参数

### 8.2 业务风险
- **用户获取困难**: 制定推广策略
- **用户留存率低**: 持续优化产品体验
- **数据安全问题**: 严格的安全措施

### 8.3 应对策略
- 分阶段开发，快速迭代
- 充分的测试和用户反馈
- 建立监控和告警系统
- 准备备选技术方案

---

## 9. 成功指标 (KPI)

### 9.1 用户指标
- 注册用户数
- 日活跃用户数 (DAU)
- 月活跃用户数 (MAU)
- 用户留存率（次日、7日、30日）

### 9.2 功能指标
- 行程创建数量
- AI生成成功率
- 语音使用率
- 计划完成率

### 9.3 性能指标
- 页面平均加载时间
- AI平均响应时间
- 系统可用性 (99%+)
- 错误率 (<1%)

### 9.4 用户满意度
- 用户评分
- NPS (净推荐值)
- 用户反馈质量

---

## 10. 附录

### 10.1 术语表
- **MVP**: Minimum Viable Product，最小可行产品
- **API**: Application Programming Interface，应用程序接口
- **UI/UX**: User Interface / User Experience，用户界面/用户体验
- **PRD**: Product Requirements Document，产品需求文档
- **LLM**: Large Language Model，大语言模型

### 10.2 参考资源
- [Supabase文档](https://supabase.com/docs)
- [高德地图API文档](https://lbs.amap.com/api/javascript-api/summary)
- [科大讯飞语音API文档](https://www.xfyun.cn/doc/)
- [OpenAI API文档](https://platform.openai.com/docs)

### 10.3 版本历史
- v1.0 (2025-10-22): 初始版本创建

---

## 11. 特别注意事项 ⚠️

### 11.1 API密钥安全
**严格要求**:
1. ❌ **禁止**将任何API Key硬编码在代码中
2. ❌ **禁止**将API Key提交到GitHub等公开代码库
3. ✅ **必须**使用环境变量（`.env`文件，并加入`.gitignore`）
4. ✅ **必须**在设置页面提供用户输入API密钥的界面
5. ✅ **推荐**使用后端代理转发API请求，避免前端暴露密钥
6. ✅ **推荐**对用户输入的密钥进行加密存储

**实施建议**:
```javascript
// ✅ 正确做法
const apiKey = process.env.VITE_OPENAI_API_KEY; // 从环境变量读取

// ❌ 错误做法
const apiKey = "sk-xxxxxxxxxxxxxxxx"; // 硬编码密钥
```

**.gitignore 必须包含**:
```
.env
.env.local
.env.development
.env.production
```

### 11.2 免费额度使用
- 选择提供免费额度的服务
- 实施请求频率限制
- 添加使用量监控和告警
- 优化API调用次数（缓存、批处理）

### 11.3 开发最佳实践
- 使用代码规范检查工具（ESLint, Prettier）
- 编写清晰的代码注释
- 遵循Git提交规范
- 定期进行代码审查
- 保持依赖包更新

---

**文档结束**
